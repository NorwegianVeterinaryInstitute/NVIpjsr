% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_query_outbreak.R
\name{build_query_outbreak}
\alias{build_query_outbreak}
\title{Builds query to select data for a disease outbreak from PJS}
\usage{
build_query_outbreak(
  period,
  utbrudd = NULL,
  hensikt = NULL,
  analytt = NULL,
  metode = NULL,
  db = "PJS"
)
}
\arguments{
\item{period}{[\code{numeric}]\cr
Time period given as year. One year or a vector giving the first
and last years that should be selected.}

\item{utbrudd}{[\code{character}]\cr
Utbruddsid(er) that should be selected. Defaults to \code{NULL}.}

\item{hensikt}{[\code{character}]\cr
Specific hensiktkoder. If sub-hensikter should be included,
end the code with \%. Defaults to \code{NULL}.}

\item{analytt}{[\code{character}]\cr
Analyttkoder that should be selected. If sub-analytter should be included,
end the code with \%. Defaults to \code{NULL}.}

\item{metode}{[\code{character}]\cr
Specific metodekoder. Defaults to \code{NULL}.}

\item{db}{[\code{character(1)}]\cr
The database for which the query is built. Defaults to "PJS" that currently
is the only valid value.}
}
\value{
A list with select-statements for "v2_sak_m_res" and "v_sakskonklusjon",
    respectively.
}
\description{
Builds a query to select all data for a disease outbreak from
    PJS. The input are utbruddsid, hensiktskoder, analyttkoder for the
    infectious agent and/or disease, and metodekoder specific for the
    infection and/or disease. The the query is written in T-SQL as used by MS-SQL.
}
\details{
The function builds select statements with SQL syntax to
    select all PJS-saker regarding a disease outbreak from PJS.
    The select statements can thereafter be used to query
    journal_rapp/PJS using
    \ifelse{html}{\code{\link[DBI:dbGetQuery]{DBI::dbGetQuery}}}{\code{DBI::dbGetQuery}}
    when using \code{odbc} or
    \ifelse{html}{\code{\link[RODBC:sqlQuery]{RODBC::sqlQuery}}}{\code{RODBC::sqlQuery}}
    when using \code{RODBC}.

    The select statements are build to
    select all journals within an outbreak where an outbreak being
    defined by an utbruddsid, hensiktkoder and/or analyttkoder for the
    infectious agent and/or disease. At least one of these must be given as
    input to the function.

    The utbruddsid is the internal id of the utbrudd in the utbrudds-register
    in PJS. One or more utbruddsid may be given as input.

    One or more hensiktkoder may be input to the selection statement. These
    may define the outbreak by themselves or may be input in addition to the
    utbruddsid and/or analyttkode.

    One or more analyttkoder may be input to the selection statement. These
    may define the outbreak by themselves or may be input in addition to the
    utbruddsid and/or hensiktkode.

    In addition one or more specific metoder may be input to the selection
    statement. With specific metode is meant a metode that implies an
    examination that will give one of the input analytter as a result. These
    cannot be sufficient to define the outbreak, but is included if the
    outbreak is defined as all samples examined for a specific analytt.
}
\examples{
# SQL-select query for an outbreak
build_query_outbreak(period = 2022,
                     utbrudd = "27",
                     hensikt = c("0100101014", "0100102005", "0100103005",
                                 "0100104029", "0200130\%"),
                     analytt = "01130301\%",
                     metode = NULL)
}
\author{
Petter Hopp Petter.Hopp@vetinst.no
}
