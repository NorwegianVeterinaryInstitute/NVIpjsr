% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_query_one_disease.R
\name{build_query_one_disease}
\alias{build_query_one_disease}
\title{Builds query for selecting data for one disease from PJS}
\usage{
build_query_one_disease(
  year,
  analytt,
  hensikt = NULL,
  metode = NULL,
  db = "PJS"
)
}
\arguments{
\item{year}{[\code{numeric}]\cr
One year or a vector giving the first and last years that should 
be selected.}

\item{analytt}{[\code{character}]\cr
Analyttkoder that should be selected. If sub-analytter should be included,
end the code with \%.}

\item{hensikt}{[\code{character}]\cr
Specific hensiktkoder. If sub-hensikter should be included,
end the code with \%. Defaults to \code{NULL}.}

\item{metode}{[\code{character}]\cr
Specific metodekoder. Defaults to \code{NULL}.}

\item{db}{[\code{character(1)}]\cr
The database for which the query is built. Defaults to "PJS" that currently
is the only valid value.}
}
\value{
A list with select-statements for "v2_sak_m_res" and "v_sakskonklusjon",
    respectively. The statements can thereafter be included in a
    \ifelse{html}{\code{\link[RODBC:sqlQuery]{RODBC::sqlQuery}}}{\code{RODBC::sqlQuery}}.
}
\description{
Builds the query for selecting all data for one
    infection/disease within one year from PJS. The input is the
    analytter for the infectious agent and/or disease, the
    hensikter and metoder specific for the infection and/or
    disease. The the query is written in T-SQL as used by MS-SQL.
}
\details{
The function builds the SQL syntax to select all PJS-journals
    concerning one infection and/or disease from PJS. This is based
    on selecting all journals with the disease and/or infectious
    agent analytt in resultat, konklusjon or sakskonklusjon. By this,
    all journals were the examination have been performed and a
    result has been entered should be selected.

    One or more specific hensikter may be input to the selection
    statement. With specific hensikt is meant a hensikt that will
    imply that the sample will be examined for the infectious agent
    or disease. Thereby, the selection will include samples that
    haven't been set up for examination yet, samples that were
    unfit for examination and samples for which wrong conclusions
     have been entered.

    One or more specific metoder may be input to the selection
    statement. With specific metode is meant a metode that implies
    an examination that will give one of the input analytter as a
    result. Thereby, the query will include samples that have been
    set up for examination, but haven't been examined yet, samples
    that were unfit for examination and samples for which wrong
    results have been entered.

    To select both the disease analytt and the infectious agent
    analytt ensures that all journals that have been examined with
    a result is included in the output. The inclusion of specific
    hensikter and metoder, if exists, ensures that all journals
    received with the purpose of examining for the infectious agent
    and/or disease will be included even if the examination has
    not been performed. This is important for a full control of
    all relevant data for an infectious agent and/or disease.
}
\examples{
# SQL-select query for Pancreatic disease (PD)
build_query_one_disease(year = 2020,
                        analytt = c("01220104\%", "1502010235"),
                        hensikt = c("0100108018", "0100109003", "0100111003", "0800109"),
                        metode = c("070070", "070231", "010057", "060265"))
}
\author{
Petter Hopp Petter.Hopp@vetinst.no
}
